{% extends 'base.html' %}
{% load static %}



{% block css_imports %}



{% endblock%}

{% block header %}
  <!--==========================
  Header
  ============================-->
  <header id="header">
    <div class="container">

      <div id="logo" class="pull-left">
        <!-- Uncomment below if you prefer to use a text logo -->
        <!-- <h1><a href="#hero">Cinemaple</a></h1> -->
        <a href="#hero"><img   src="{% static 'userhandling/img/logos/logo_cinemaple.png' %}" alt="" title="" height="40" /></img></a>
      </div>

      <nav id="nav-menu-container">
        <ul class="nav-menu">
          <li><a href={% url 'curr_mov_nights' %}>Current Movie Night</a></li>
          {% if request.user.is_staff %}
          <li><a href={% url 'add_movie_night' %}>Add Movie Night</a></li>
          <li><a href={% url 'man_mov_nights' %}>Manage Movie Nights</a></li>
          <li><a href={% url 'ml_health' %}>Mailing List Healths</a></li>
          {% endif %}
        {% if user.is_authenticated %}
        <li>  <a href={% url 'logout'%} data-toggle="modal" data-target="#logoutmodal" style="font-weight:bold; color:#af353b" class="btn-get-started">Logout</a> </li>
        <li> <font color = #af353b>Welcome, {{request.user.first_name}}!</font> </li>
        {% else %}
        <li>  <a href="{% url 'login' %}" style="font-weight:bold; color:#af353b" class="btn-get-started">Login</a> </li>
      {% endif %}
        </ul>
      </nav><!-- #nav-menu-container -->
    </div>
  </header><!-- #header -->
{% endblock %}


{% block main %}
<div class="container-fluid">
    <!-- Content Row -->
    <div class="row">




        <!-- Earnings (Monthly) Card Example -->
        <!-- Area Chart -->
        <div class="col-xl-12 col-lg-12">
            <div class="card shadow mb-4">
                <!-- Card Header - Dropdown -->
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">Registration Step {% if voting_enabled %}2/2 {% else %} 1/1 {% endif %}: Add Toppings.</h6>
                </div>
                <!-- Card Body -->
                <div class="card-body">

<form action="{{ request.path }}" method="post">
    {% csrf_token %}
    {{ form }}
    <ul class="listnobullets">
    <li><button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#AddToppingModal">Add Topping</button>
    </li>
</ul>

    {{ form_brought_along }}
    <input type="submit" class="btn btn-primary" value="Finish Registration">
</form>




                </div>
            </div>
        </div>
    </div>

</div>
<!-- /.container-fluid -->
{% endblock %}




{% block modals %}

<div class="modal fade" id="AddToppingModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add Topping</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">

                <form id="AddToppingForm" action="{{ request.path }}" method="post">
                {% csrf_token %}
                {{ toppingaddform }}
                </form>

            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                <input class="btn btn-primary odom-submit" type="submit" value="Add Topping">

            </div>
        </div>
    </div>
</div>




<div class="modal fade" id="toolatevote" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Voting disabled</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">The voting window has expired, you are not able to cast a vote for this movienight but are still welcome to register!
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" type="button" data-dismiss="modal">Cool</button>
            </div>
        </div>
    </div>
</div>


{% endblock %}


{% block js %}
<script>

        $(function () {
            $('body').on('click', '.odom-submit', function (e) {
                $('#AddToppingForm').submit();
                $('#AddToppingModal').modal('hide');
            });
        });


{% if not voting_enabled and not second_load %}
$('#toolatevote').modal('show');
 {% endif %}
</script>


{% endblock %}